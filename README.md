# WaterP1MeterKit firmware – GitHub Pages branch (gh-pages)

This branch hosts the public firmware artifacts and manifests for WaterP1MeterKit. It is served via GitHub Pages and is intended to be consumed by:

- ESP Web Tools (browser-based flashing)
- OTA update integrations (using the JSON manifest)
- Home Assistant ESPHome update entities

## Do not edit manually

Files in this branch are generated by the CI workflow in the default branch. Any manual changes will be overwritten on the next publish.

## Layout

The firmware is organized by version and variant:

```
gh-pages/
├── waterp1meterkit-v1-wifi/
│   ├── waterp1meterkit.factory.bin
│   ├── waterp1meterkit.ota.bin
│   └── manifest.json
├── waterp1meterkit-v1-wifi-manifest.json
├── waterp1meterkit-v1-ethernet/
│   └── ...
├── waterp1meterkit-v1-ethernet-manifest.json
├── waterp1meterkit-v2-wifi/
│   └── ...
├── waterp1meterkit-v2-wifi-manifest.json
├── waterp1meterkit-v2-ethernet/
│   └── ...
├── waterp1meterkit-v2-ethernet-manifest.json
├── waterp1meterkit-v3-wifi/
│   └── ...
├── waterp1meterkit-v3-wifi-manifest.json
├── waterp1meterkit-v3-ethernet/
│   └── ...
└── waterp1meterkit-v3-ethernet-manifest.json
```

## OTA update manifest

The WaterP1MeterKit ESPHome firmware consumes the manifest files directly for OTA updates:

| Version | WiFi Manifest | Ethernet Manifest |
|---------|---------------|-------------------|
| V1 | `waterp1meterkit-v1-wifi-manifest.json` | `waterp1meterkit-v1-ethernet-manifest.json` |
| V2 | `waterp1meterkit-v2-wifi-manifest.json` | `waterp1meterkit-v2-ethernet-manifest.json` |
| V3 | `waterp1meterkit-v3-wifi-manifest.json` | `waterp1meterkit-v3-ethernet-manifest.json` |

## How this branch is updated

- On pushes to the default branch (or when manually dispatched), the CI pipeline:
  1. Detects which versions have changed
  2. Builds WiFi and Ethernet variants with ESPHome
  3. Exports firmware and per-variant manifests
  4. Deploys this folder structure to the `gh-pages` branch

- On a schedule (20th of each month), all firmware is rebuilt with the latest ESPHome version to include bugfixes and improvements.

## URLs

Firmware is available at:
- `https://smarthomeshop.github.io/waterp1meterkit/<manifest-filename>`

Example:
- `https://smarthomeshop.github.io/waterp1meterkit/waterp1meterkit-v3-wifi-manifest.json`

